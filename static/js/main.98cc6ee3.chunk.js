(this.webpackJsonpbattlegrid=this.webpackJsonpbattlegrid||[]).push([[0],{15:function(e,t,n){e.exports=n(30)},20:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),o=n(4),a=n.n(o),i=(n(20),n(1)),l=(n(21),n(14));var u=c.a.memo((function(e){return c.a.createElement("div",{style:{position:"absolute",left:"0",top:"0",width:e.width+"em",height:e.height+"em",backgroundPosition:"top left",background:"repeating-linear-gradient(to right, grey, grey ".concat("0.05em",", transparent ").concat("0.05em"," 1em), repeating-linear-gradient(to bottom, grey, grey ").concat("0.05em",", transparent ").concat("0.05em"," 1em)")}})})),s=(n(22),n(11));function f(e,t,n){return Math.min(n,Math.max(t,e))}var d=n(8),m=Object(r.memo)(Object(r.forwardRef)((function(e,t){var n=Object(r.useRef)(null),o=Object(r.useRef)(null),a=Object(r.useRef)({scale:1,offset:[0,0]}),i=function(t){var r=t(a.current),c=[f(r.offset[0],0,e.width),f(r.offset[1],0,e.height)];a.current={scale:r.scale,offset:c},console.log("offset",a.current.offset),o.current.style.fontSize="".concat(a.current.scale*e.baseScalar).concat(e.baseUnit),n.current.scrollTo(96*a.current.offset[0]*a.current.scale,a.current.offset[1]*a.current.scale*96)},l=Object(r.useRef)(1);Object(d.a)({onPinchEnd:function(){l.current=a.current.scale},onPinch:function(e){var t,n,r;null===(t=e.event)||void 0===t||t.preventDefault(),null===(n=e.event)||void 0===n||n.stopPropagation();var c,o=null===(r=e.event)||void 0===r?void 0:r.deltaY,s=e.event,d=u([s.clientX,s.clientY]);if(console.log(d),o){var m=-1*o*.05*a.current.scale;c=a.current.scale+m}else c=e.da[0]/e.initial[0]-1+l.current;!function(e,t,n){var r=f(n-t,-.05,.05);(n=f(t+r,.2,2))!==t&&i((function(c){return console.log(a.current.scale),{scale:n,offset:[c.offset[0]-(c.offset[0]-e[0])*r/t,c.offset[1]-(c.offset[1]-e[1])*r/t]}}))}(d,a.current.scale,c)},onPinchStart:Object(r.useCallback)((function(e){console.log("pinchstarting"),l.current=a.current.scale}),[a])},{domTarget:n,eventOptions:{passive:!1,capture:!0}});var u=function(e){var t=o.current.getBoundingClientRect();return[(e[0]-t.left)/96/a.current.scale,(e[1]-t.top)/96/a.current.scale]};Object(r.useImperativeHandle)(t,(function(){return{clientToGrid:u}}),[]);var m=Object(d.a)({onScrollEnd:function(e){console.log("OOPS",e.pinching),i((function(e){return Object(s.a)(Object(s.a)({},e),{},{offset:[n.current.scrollLeft/96/a.current.scale,n.current.scrollTop/96/a.current.scale]})}))}});return c.a.createElement("div",Object.assign({className:"viewport"},m(),{ref:n}),c.a.createElement("div",{className:"gridsvg",ref:o,style:{width:"".concat(e.width,"em"),height:"".concat(e.height,"em"),fontSize:"".concat(a.current.scale*e.baseScalar).concat(e.baseUnit),position:"relative"}},e.children))})));var h=Object(r.memo)((function(e){var t,n=Object(r.useRef)(null),o=Object(r.useRef)(null),a=Object(r.useRef)(null),s=Object(r.useState)([]),f=Object(i.a)(s,2),d=f[0],h=f[1],g=function(e,t,n){var c=Object(r.useState)(0),o=Object(i.a)(c,2),a=o[0],l=o[1],u=Object(r.useState)({x:0,y:0}),s=Object(i.a)(u,2),f=s[0],d=s[1];return console.log(a),[a>0,f,{onDragEnter:function(e){e.preventDefault(),e.stopPropagation();var t=[e.clientX,e.clientY],n=t[0],r=t[1];l((function(e){return e+1})),d({x:n,y:r})},onDragLeave:function(e){e.preventDefault(),e.stopPropagation();var t=[e.clientX,e.clientY],n=t[0],r=t[1];l((function(e){return e-1})),d({x:n,y:r})},onDragOver:function(e){e.preventDefault(),t(e.clientX,e.clientY)},onDrop:function(e){e.preventDefault(),console.log("DROPPED!");var t=[e.clientX,e.clientY],r=t[0],c=t[1];l(0),d({x:r,y:c}),n(e)}}]}(0,(function(e,t){if(a.current){var n=o.current.clientToGrid([e,t]);a.current.style.left=Math.floor(n[0])+"em",a.current.style.top=Math.floor(n[1])+"em"}}),(function(e){var t,n,r=o.current.clientToGrid([e.clientX,e.clientY]);console.log("DROP!");var c=null!==(t=null===(n=e.dataTransfer)||void 0===n?void 0:n.items)&&void 0!==t?t:[],a=function(e,t){console.log("adding item?");var n={id:""+Math.random(),x:Math.floor(r[0])+t,y:Math.floor(r[1]),width:1,height:1,href:e};console.log("DROPPING? ",n),h([].concat(Object(l.a)(d),[n]))};console.log("event",e),console.log("items",c);for(var i=0;i<c.length;i++)console.log(c[i]),c[i].kind.startsWith("image/")?a(window.URL.createObjectURL(c[i].getAsFile()),0):"text/uri-list"===c[i].type&&c[i].getAsString((function(e){return a(e,0)}))})),v=Object(i.a)(g,3),b=v[0],p=v[1],O=v[2];return b&&(t=o.current.clientToGrid([p.x,p.y])),c.a.createElement("div",Object.assign({className:"grid"},O,{ref:n}),c.a.createElement(m,{ref:o,baseScalar:1,baseUnit:"in",width:e.dimensions[0],height:e.dimensions[1]},b?c.a.createElement("div",{ref:a,key:"hover",style:{position:"absolute",left:Math.floor(t[0])+"em",top:Math.floor(t[1])+"em",width:"1em",height:"1em",background:"#aaa"}}):null,d.map((function(e){return c.a.createElement("img",{alt:"",key:e.id+"",src:e.href,style:{position:"absolute",left:e.x+"em",top:e.y+"em",width:"1em",height:"1em",display:"block"}})})),c.a.createElement(u,{width:e.dimensions[0],height:e.dimensions[1]})))})),g=n(6);n(29);var v=function(e){return c.a.createElement("div",{className:"toolbar"},e.children)};function b(e){return Math.floor(Math.random()*Math.floor(e))}var p=Object(g.b)()((function(){var e=Object(r.useState)({x:0,y:0,width:2,height:2}),t=Object(i.a)(e,2)[1],n=Object(r.useState)(30),o=Object(i.a)(n,2),a=o[0],l=o[1],u=Object(r.useState)(30),s=Object(i.a)(u,2),f=s[0],d=s[1];return c.a.createElement("div",{className:"App"},c.a.createElement(h,{dimensions:[a,f]}),c.a.createElement(v,null,c.a.createElement("button",{onClick:function(){t({x:b(5),y:b(5),width:b(5)+1,height:b(5)+1})}},"Add Rect"),c.a.createElement("button",{onClick:function(){return l((function(e){return e+1}))}},"Add Column"),c.a.createElement("button",{onClick:function(){return d((function(e){return e+1}))}},"Add Row")))})),O=n(2);var j={zoom:1};var y=Object(O.b)({grid:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ZOOM":return{zoom:t.zoom};default:return e}}}),E=Object(O.c)(y);a.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(g.a,{store:E},c.a.createElement(p,null))),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.98cc6ee3.chunk.js.map