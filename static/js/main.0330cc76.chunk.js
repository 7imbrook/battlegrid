(this.webpackJsonpbattlegrid=this.webpackJsonpbattlegrid||[]).push([[0],{36:function(e,t,n){e.exports=n(61)},41:function(e,t,n){},42:function(e,t,n){},44:function(e,t,n){},51:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=51},52:function(e,t,n){},53:function(e,t,n){},59:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(15),c=n.n(o),i=(n(41),n(10)),s=(n(42),n(1)),u=n.n(s),l=n(2);function d(e){return[e.clientX,e.clientY]}function f(e){return e.map(Math.floor)}function m(e,t){return[e[0]+t[0],e[1]+t[1]]}function p(e,t,n){return Math.min(n,Math.max(t,e))}var v=a.a.memo((function(e){return a.a.createElement("div",{style:{position:"absolute",left:"".concat(-.025,"em"),right:"".concat(-.025,"em"),top:"".concat(-.025,"em"),bottom:"".concat(-.025,"em"),background:"\n      repeating-linear-gradient(to right, ".concat("gray",", ").concat("gray"," ").concat(.05,"em, transparent ").concat(.05,"em 1em),\n      repeating-linear-gradient(to bottom, ").concat("gray",", ").concat("gray"," ").concat(.05,"em, transparent ").concat(.05,"em 1em)"),pointerEvents:"none",borderRight:"".concat(.05,"em solid ").concat("gray"),borderBottom:"".concat(.05,"em solid ").concat("gray"),transition:"position 2s"}})})),g=(n(44),n(8)),h=n(21),b=Object(r.memo)(Object(r.forwardRef)((function(e,t){var n=Object(r.useRef)(null),o=Object(r.useRef)(null),c=Object(r.useRef)({scale:1,offset:[0,0]}),i=function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=t(c.current),o=[p(a.offset[0],0,e.width),p(a.offset[1],0,e.height)];c.current={scale:a.scale,offset:o},r&&(n.current.style.fontSize="".concat(c.current.scale*e.baseScalar).concat(e.baseUnit),n.current.scrollTo(96*c.current.offset[0]*c.current.scale,c.current.offset[1]*c.current.scale*96))},s=Object(r.useRef)(1),u=Object(h.a)({onPinchEnd:function(){s.current=c.current.scale},onPinch:function(e){var t,n,r;null===(t=e.event)||void 0===t||t.preventDefault(),null===(n=e.event)||void 0===n||n.stopPropagation();var a,o=null===(r=e.event)||void 0===r?void 0:r.deltaY,u=e.origin||[e.event.clientX,e.event.clientY],d=l(u);if(o){var f=-1*o*.05*c.current.scale;a=c.current.scale+f}else a=e.da[0]/e.initial[0]-1+s.current;!function(e,t,n){var r=p(n-t,-.05,.05);(n=p(t+r,.2,2))!==t&&i((function(a){return{scale:n,offset:[a.offset[0]-(a.offset[0]-e[0])*r/t,a.offset[1]-(a.offset[1]-e[1])*r/t]}}))}(d,c.current.scale,a)},onPinchStart:Object(r.useCallback)((function(e){var t,n;null===(t=e.event)||void 0===t||t.preventDefault(),null===(n=e.event)||void 0===n||n.stopPropagation(),s.current=c.current.scale}),[c])},{domTarget:n,eventOptions:{passive:!1,capture:!0}});Object(r.useEffect)(u,[u]);var l=function(e){var t=o.current.getBoundingClientRect();return[(e[0]-t.left)/96/c.current.scale,(e[1]-t.top)/96/c.current.scale]};Object(r.useImperativeHandle)(t,(function(){return{clientToGrid:l}}),[]);var d=Object(h.a)({onScrollEnd:function(e){i((function(e){return Object(g.a)(Object(g.a)({},e),{},{offset:[n.current.scrollLeft/96/c.current.scale,n.current.scrollTop/96/c.current.scale]})}),!1)}});return a.a.createElement("div",Object.assign({className:"viewport"},d(),{ref:n,style:{fontSize:"".concat(c.current.scale*e.baseScalar).concat(e.baseUnit)}}),a.a.createElement("div",{className:"padding"},a.a.createElement("div",{ref:o,className:"gridsvg",style:{width:"".concat(e.width,"em"),height:"".concat(e.height,"em"),position:"relative"}},e.children)))})));var O=n(13),y=Object(r.memo)(Object(r.forwardRef)((function(e,t){return a.a.createElement(O.b.div,Object.assign({},e,{ref:t,style:Object(g.a)({position:"absolute"},e.style),initial:!1,transition:{type:"tween",ease:"easeOut",duration:.2},animate:{left:e.loc[0]+"em",top:e.loc[1]+"em",width:e.dim[0]+"em",height:e.dim[1]+"em"}}),e.children)})));var E=function(e){var t=Object(r.useRef)(null),n=Object(r.useCallback)((function(n){(t.current||"mouse"===n.type)&&(n.stopPropagation(),e.onSelectionDrag(d(n)))}),[e]),o=Object(r.useCallback)((function(n){null!==t.current&&(n.preventDefault(),n.stopPropagation(),e.onSelectionDrop(d(n)),t.current=null)}),[e]),c=Object(r.useRef)();return Object(r.useEffect)((function(){var e;null===(e=c.current)||void 0===e||e.addEventListener("touchmove",(function(e){return e.preventDefault()}),{passive:!1})})),a.a.createElement(y,{ref:c,loc:e.loc,dim:e.dim,style:{border:"2px solid highlight",boxShadow:"0 0 10px highlight"},onPointerDown:function(e){e.preventDefault(),e.stopPropagation(),e.currentTarget.setPointerCapture(e.pointerId),t.current=d(e)},onPointerMoveCapture:n,onPointerUpCapture:o})},j=n(3),S=n(4),w=n(16),_=n(17),P=n(63),T=n(28),D=n.n(T),C=Object({NODE_ENV:"production",PUBLIC_URL:"/battlegrid",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_PEERJS_HOST:"peers-peerjs-server-3.glitch.me",REACT_APP_PEERJS_PORT:"443"}),x=C.REACT_APP_PEERJS_HOST,R=C.REACT_APP_PEERJS_PORT;function k(e){return N.apply(this,arguments)}function N(){return(N=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("ENV??",Object({NODE_ENV:"production",PUBLIC_URL:"/battlegrid",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_PEERJS_HOST:"peers-peerjs-server-3.glitch.me",REACT_APP_PEERJS_PORT:"443"})),n=new D.a(t,{debug:3,host:x,secure:!0,port:R?parseInt(R):void 0,path:"/"}),e.abrupt("return",new Promise((function(e,t){var r=function(e){o(),t("Error establishing peer: ".concat(e))},a=function(){o(),console.log("OPENING?"),e(n)},o=function(){n.off("open",a),n.off("error",r)};n.on("open",a),n.on("error",r)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e,t){return A.apply(this,arguments)}function A(){return(A=Object(l.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.connect(n),e.abrupt("return",new Promise((function(e,t){var n=function(e){o(),t("Error establishing peer: ".concat(e))},a=function(){o(),e(r)},o=function(){r.off("open",a),r.off("error",n)};r.on("open",a),r.on("error",n)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Object({NODE_ENV:"production",PUBLIC_URL:"/battlegrid",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_PEERJS_HOST:"peers-peerjs-server-3.glitch.me",REACT_APP_PEERJS_PORT:"443"}).PEERJS_ROOM_PREFIX;var M=function(){function e(t,n,r,a){Object(w.a)(this,e),this.dc=void 0,this.remote_id=void 0,this.config=void 0,this.id=void 0,this.dc=t,this.remote_id=n,this.config=a,this.id=r,this.attachListeners(this.dc)}return Object(_.a)(e,[{key:"attachListeners",value:function(e){var t=this;this.dc.on("close",(function(){var e=function(){var n=Object(l.a)(u.a.mark((function n(){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.config.onDisconnect(),n.prev=1,n.t0=I,n.next=5,k(t.id);case 5:return n.t1=n.sent,n.t2=t.remote_id,n.next=9,(0,n.t0)(n.t1,n.t2);case 9:t.dc=n.sent,t.attachListeners(t.dc),n.next=17;break;case 13:n.prev=13,n.t3=n.catch(1),console.log("failed to reconnect"),setTimeout(e,1e3);case 17:case"end":return n.stop()}}),n,null,[[1,13]])})));return function(){return n.apply(this,arguments)}}();e()})),this.dc.on("error",(function(){var e=function(){var n=Object(l.a)(u.a.mark((function n(){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.config.onDisconnect(),n.prev=1,n.t0=I,n.next=5,k(t.id);case 5:return n.t1=n.sent,n.t2=t.remote_id,n.next=9,(0,n.t0)(n.t1,n.t2);case 9:t.dc=n.sent,t.attachListeners(t.dc),n.next=17;break;case 13:n.prev=13,n.t3=n.catch(1),console.log("failed to reconnect"),setTimeout(e,1e3);case 17:case"end":return n.stop()}}),n,null,[[1,13]])})));return function(){return n.apply(this,arguments)}}();e()})),this.dc.on("data",(function(e){console.log("INCOMING!"),t.config.onMessage(e)})),this.config.onConnect(this)}},{key:"send",value:function(e){this.dc.send(e)}}],[{key:"create",value:function(){var t=Object(l.a)(u.a.mark((function t(n,r,a){var o;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=I,t.next=3,k(r);case 3:return t.t1=t.sent,t.t2=n,t.next=7,(0,t.t0)(t.t1,t.t2);case 7:return o=t.sent,t.abrupt("return",new e(o,n,r,a));case 9:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}(),L=n(29),J=function(){function e(t,n,r){var a=this;Object(w.a)(this,e),this.peer=void 0,this.clients=void 0,this.id=void 0,this.peer=n,this.id=t,this.clients=new Map,this.peer.on("connection",(function(e){e.on("open",(function(){console.log("NEW CLIENT",e.peer);var t=e.peer;a.clients.set(t,e),r.onConnect&&r.onConnect(t),e.on("data",(function(t){a.broadcast_json(t,e.peer),r.onMessage&&r.onMessage(t)})),e.on("close",(function(){a.clients.delete(e.peer)})),e.on("error",(function(){a.clients.delete(e.peer)})),r.onDisconnect&&e.on("close",(function(){console.log("close?"),r.onDisconnect(t)})),r.onDisconnect&&e.on("error",(function(){console.log("error?"),r.onDisconnect(t)}))}))})),this.peer.on("disconnected",(function(){console.error("ACK! Disconnect from signaler.")}))}return Object(_.a)(e,[{key:"broadcast_json",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=Object(L.a)(this.clients);try{for(r.s();!(t=r.n()).done;){var a=Object(i.a)(t.value,2),o=a[0],c=a[1];o!==n&&c.send(e)}}catch(s){r.e(s)}finally{r.f()}}},{key:"send",value:function(e){this.broadcast_json(e)}},{key:"sendTo",value:function(e,t){this.clients.get(e).send(t)}}],[{key:"create",value:function(){var t=Object(l.a)(u.a.mark((function t(n,r){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k(n);case 2:return a=t.sent,t.abrupt("return",new e(a.id,a,r));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),H=function(e){return new Promise((function(t){return setTimeout(t,e)}))},U=Object(S.b)("toast/issue",function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,a=Date.now(),r(Y({id:Date.now(),msg:t})),e.next=5,H(5e3);case 5:r(F(a));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),G=Object(S.c)({name:"toast",initialState:{toasts:[]},reducers:{addToast:function(e,t){var n=t.payload;e.toasts.push(n)},removeToast:function(e,t){var n=t.payload;e.toasts=e.toasts.filter((function(e){return e.id!==n}))}}}),W=G.reducer,K=G.actions,Y=K.addToast,F=K.removeToast;var X={was_hosting:function(){return null},comms_id:P.a,player_name:function(){return null},game:function(){return null}},B=function(e){var t=sessionStorage.getItem(e);if(t)return JSON.parse(t);var n=X[e]();return sessionStorage.setItem(e,JSON.stringify(n)),n},V=function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},z=Object(S.c)({name:"players",initialState:{},reducers:{addPlayer:ae((function(e,t){e[t.payload.id]=t.payload})),removePlayer:ae((function(e,t){delete e[t.payload]}))}}),q=z.reducer,Q=z.actions,Z=Q.addPlayer,$=Q.removePlayer,ee={conn:null},te=Object(S.b)("comms/connect",function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,a=n.dispatch,e.prev=1,e.next=4,M.create(t,r().comms.clientId,{onMessage:function(e){a(e)},onDisconnect:function(){a(re.actions.disconnected())},onConnect:function(e){a(re.actions.connected()),console.log("connected to server!")}});case 4:return ee.conn=e.sent,e.abrupt("return",t);case 8:throw e.prev=8,e.t0=e.catch(1),a(U("joinFailure")),e.t0;case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()),ne=Object(S.b)("comms/host",function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r,a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,a=n.dispatch,e.next=3,J.create(r().comms.clientId,{onConnect:function(e){var t;o.sendTo(e,{type:"STATE_SYNC",payload:{game:(t=r()).game,players:t.players}})},onMessage:function(e){a(e)},onDisconnect:function(e){a($(e))}});case 3:return o=e.sent,ee.conn=o,V("was_hosting",o.id),a(ve(o.id)),window.history.pushState(null,"","?game=".concat(o.id)),e.abrupt("return",o.id);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),re=Object(S.c)({name:"comms",initialState:{status:"offline",hosting:!1,clientId:B("comms_id"),gameId:null},reducers:{disconnected:function(e,t){e.status="pending"},connected:function(e,t){e.status="connected"}},extraReducers:function(e){e.addCase(te.pending,(function(e,t){e.status="pending"})),e.addCase(te.fulfilled,(function(e,t){var n=t.payload;e.gameId=n,e.status="connected"})),e.addCase(te.rejected,(function(e,t){e.status="offline"})),e.addCase(ne.pending,(function(e,t){e.status="pending"})),e.addCase(ne.fulfilled,(function(e,t){var n=t.payload;e.status="connected",e.gameId=n,e.hosting=!0})),e.addCase(ne.rejected,(function(e,t){e.status="offline"}))}});function ae(e){return{reducer:e,prepare:function(e){return{payload:e,meta:ee.conn?{shared:!0,src:ee.conn.id}:{}}}}}var oe=re.reducer,ce={id:"local",maps:[{width:15,height:10,images:{}}]},ie=Object(S.c)({name:"game",initialState:ce,reducers:{forkGame:function(e,t){e.id=t.payload},loadGame:function(e,t){return t.payload},setDimensions:ae((function(e,t){var n=t.payload,r=n.map,a=n.width,o=n.height;e.maps[r].width=a,e.maps[r].height=o})),addImage:ae((function(e,t){var n=t.payload,r=n.map,a=n.img;e.maps[r].images[a.id]=a})),updateImage:ae((function(e,t){var n=t.payload,r=n.map,a=n.id,o=n.img;e.maps[r].images[a]=Object(g.a)(Object(g.a)({},e.maps[r].images[a]),o)})),reset:ae((function(e,t){return ce}))}}),se=ie.reducer,ue=ie.actions,le=ue.setDimensions,de=ue.addImage,fe=ue.updateImage,me=ue.reset,pe=ue.loadGame,ve=ue.forkGame;function ge(e){return he.apply(this,arguments)}function he(){return(he=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FileReader,e.abrupt("return",new Promise((function(e,r){n.onload=function(){return e(n.result)},n.readAsDataURL(t)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){var t;return(null===(t=(new DOMParser).parseFromString(e,"text/html").querySelector("img"))||void 0===t?void 0:t.src)||null}var Oe=Object(r.memo)((function(e){var t,n=Object(r.useRef)(null),o=Object(r.useRef)(null),c=Object(r.useState)(null),s=Object(i.a)(c,2),d=s[0],p=s[1],g=Object(r.useRef)(null),h=Object(r.useRef)(null),O=Object(j.c)((function(e){return e.game.maps[0].images})),S=Object(j.b)(),w=function(e,t,n){var a=Object(r.useState)(0),o=Object(i.a)(a,2),c=o[0],s=o[1],u=Object(r.useState)({x:0,y:0}),l=Object(i.a)(u,2),d=l[0],f=l[1];return[c>0,d,{onDragEnter:function(e){e.preventDefault(),e.stopPropagation();var t=[e.clientX,e.clientY],n=t[0],r=t[1];s((function(e){return e+1})),f({x:n,y:r})},onDragLeave:function(e){e.preventDefault(),e.stopPropagation();var t=[e.clientX,e.clientY],n=t[0],r=t[1];s((function(e){return e-1})),f({x:n,y:r})},onDragOver:function(e){e.preventDefault(),t(e.clientX,e.clientY)},onDrop:function(e){e.preventDefault();var t=[e.clientX,e.clientY],r=t[0],a=t[1];s(0),f({x:r,y:a}),n(e)}}]}(0,(function(e,t){if(h.current){var n=g.current.clientToGrid([e,t]);h.current.style.left=Math.floor(n[0])+"em",h.current.style.top=Math.floor(n[1])+"em"}}),function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a,o,c,i,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=g.current.clientToGrid([t.clientX,t.clientY]),o=null!==(n=null===(r=t.dataTransfer)||void 0===r?void 0:r.items)&&void 0!==n?n:[],c=function(e){console.log(e);var t={id:""+Math.random(),loc:[Math.floor(a[0]),Math.floor(a[1])],dim:[1,1],href:e};S(de({map:0,img:t}))},console.log("DataItems",o.length),i=0;case 5:if(!(i<o.length)){e.next=25;break}if(console.log(o[i].type),!o[i].type.startsWith("image/")){e.next=13;break}return e.next=10,ge(o[i].getAsFile());case 10:return s=e.sent,c(s),e.abrupt("return");case 13:if("text/html"!==o[i].type){e.next=16;break}return o[i].getAsString((function(e){return c(be(e))})),e.abrupt("return");case 16:if("application/x-moz-file-promise-url"!==o[i].type){e.next=21;break}return o[i].getAsString(c),e.abrupt("return");case 21:"string"===o[i].kind&&function(){var e=o[i].type;o[i].getAsString((function(t){return console.log(e,t)}))}();case 22:i++,e.next=5;break;case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),_=Object(i.a)(w,3),P=_[0],T=_[1],D=_[2];return P&&(t=g.current.clientToGrid([T.x,T.y])),a.a.createElement("div",Object.assign({className:"grid"},D,{ref:n}),a.a.createElement(b,{ref:g,baseScalar:1,baseUnit:"in",width:e.dimensions[0],height:e.dimensions[1]},P?a.a.createElement("div",{ref:h,key:"hover",style:{position:"absolute",left:Math.floor(t[0])+"em",top:Math.floor(t[1])+"em",width:"1em",height:"1em",background:"#aaa"}}):null,Object.values(O).map((function(e){var t;return a.a.createElement(y,{key:e.id,loc:m(e.loc,(null===(t=o.current)||void 0===t?void 0:t.id)===e.id?d:[0,0]),dim:e.dim,onPointerDown:function(t){t.preventDefault(),o.current=e,p([0,0])}},a.a.createElement("img",{onDragStart:function(e){return e.preventDefault()},alt:"",src:e.href,style:{display:"block",width:"100%",height:"100%"}}))})),a.a.createElement(v,{width:e.dimensions[0],height:e.dimensions[1]}),o.current&&a.a.createElement(E,{key:"",loc:m(d,o.current.loc),dim:o.current.dim,onSelectionDrag:function(e){return p(f((t=g.current.clientToGrid(e),n=o.current.loc,[t[0]-n[0],t[1]-n[1]])));var t,n},onSelectionDrop:function(e){var t=f(g.current.clientToGrid(e));S(fe({map:0,id:o.current.id,img:{loc:t}})),p(null),o.current=null}})))}));n(52);var ye=function(e){return a.a.createElement("div",{className:"toolbar"},e.children)},Ee=(n(53),n(64));function je(e){var t=Object(j.c)((function(e){return e.toast.toasts})),n=Object(Ee.a)().t;return a.a.createElement("div",{className:"toastArea"},a.a.createElement(O.a,null,t.map((function(e){return a.a.createElement(O.b.div,{className:"toast",initial:{position:"relative",opacity:0},animate:{position:"relative",opacity:1},exit:{position:"relative",opacity:0},layout:!0,key:e.id},n(e.msg))}))))}n(59);function Se(){return a.a.createElement("div",{className:"spinner"},a.a.createElement("div",{className:"double-bounce1"}),a.a.createElement("div",{className:"double-bounce2"}))}n(60);function we(){var e=Object(j.c)((function(e){return(null!==e.comms.gameId||"offline"!==e.comms.status)&&!(e.comms.clientId in e.players)})),t=Object(j.c)((function(e){return e.comms.clientId})),n=Object(j.c)((function(e){return"connected"===e.comms.status})),r=Object(j.b)();return e?a.a.createElement("div",{id:"join"},a.a.createElement("form",{style:{display:"flex",flexDirection:"column",maxWidth:"480px"},onSubmit:_e(r,t)},a.a.createElement("label",{htmlFor:"name"},"Display Name:",a.a.createElement("input",{name:"name",type:"text",defaultValue:""})),n?a.a.createElement("button",{type:"submit"},"Join"):a.a.createElement("button",{type:"submit",disabled:!0},"Connecting... ",a.a.createElement(Se,null)))):null}var _e=function(e,t){return function(n){n.preventDefault();var r=new FormData(n.nativeEvent.target).get("name");e(Z({name:r,id:t}))}};var Pe=function(){var e=Object(j.c)((function(e){return console.log(e),e.comms})),t=Object(r.useState)((function(){return 0})),n=Object(i.a)(t,2),o=n[0],c=(n[1],Object(j.c)((function(e){return[e.game.maps[o].width,e.game.maps[o].height]}))),s=Object(j.b)(),u=Object(Ee.a)().t,l=Object(j.c)((function(e){return Object.values(e.players).map((function(e){return e.name}))}));return a.a.createElement("div",{className:"App"},a.a.createElement(we,null),a.a.createElement(je,null),a.a.createElement(Oe,{dimensions:c}),a.a.createElement(ye,null,a.a.createElement("button",{onClick:function(){return s(le({map:o,width:c[0]+1,height:c[1]}))}},"Add Column"),a.a.createElement("button",{onClick:function(){return s(le({map:o,width:c[0],height:c[1]+1}))}},"Add Row"),a.a.createElement("button",{onClick:function(){return s(me({}))}},"Reset"),a.a.createElement("button",{onClick:function(){return s(U(u("hello")))}},"Say hi"),"offline"===e.status&&a.a.createElement("button",{onClick:function(){return s(ne())}},"Host"),"pending"===e.status&&a.a.createElement(Se,null),e.hosting&&"hosting: ".concat(e.gameId),l.map((function(e){return a.a.createElement("p",null,e)}))))},Te=n(34),De=n(7);var Ce=Object(De.c)({comms:oe,game:se,toast:W,players:q}),xe=Ce(void 0,{type:"null"}),Re=Object(S.a)({reducer:function(e,t){return"STATE_SYNC"===t.type?function(e,t){return Object(g.a)(Object(g.a)({},e),{},{game:t.payload.game,players:t.payload.players})}(e,t):Ce(e,t)},middleware:function(e){return[].concat(Object(Te.a)(e()),[function(e){return function(e){return function(t){var n,r,a;return console.log("connection?",ee.conn),ee.conn&&(null===(n=t.meta)||void 0===n?void 0:n.shared)&&(null===(r=t.meta)||void 0===r?void 0:r.src)===(null===(a=ee.conn)||void 0===a?void 0:a.id)&&ee.conn.send(t),e(t)}}}])},preloadedState:xe});Re.subscribe((function(){var e=Re.getState();console.log(e),function(e,t){sessionStorage.setItem(e,JSON.stringify(t))}(e.game.id,e.game)}));var ke=Re,Ne=n(24),Ie=n(14),Ae=n(33);Ne.a.use(Ae.a).use(Ie.e).init({debug:!0,lng:"en",fallbackLng:"en",whitelist:["en","de"],interpolation:{escapeValue:!1},backend:{loadPath:"/battlegrid/locales/{{lng}}/{{ns}}.json"}});Ne.a;var Me=new URLSearchParams(window.location.search).get("game"),Le=function(e){var t=sessionStorage.getItem(e);return t?JSON.parse(t):null}(null!==Me&&void 0!==Me?Me:"local");Le&&ke.dispatch(pe(Le)),Me&&(console.log("Found game: ",Me),B("was_hosting")===Me?(console.log("REHOSTING!"),ke.dispatch(ne())):(console.log("Huh"),ke.dispatch(te(Me)))),c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(r.Suspense,{fallback:null},a.a.createElement(j.a,{store:ke},a.a.createElement(Pe,null)))),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.0330cc76.chunk.js.map