(this.webpackJsonpbattlegrid=this.webpackJsonpbattlegrid||[]).push([[0],{32:function(e,t,n){e.exports=n(57)},44:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=44},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(15),c=n.n(o),i=n(3),u=n(4),s=n(61),l=n(1),f=n.n(l),d=n(2),p=n(5),m={was_hosting:function(){return null},comms_id:n(60).a,players:function(){return{}}},h=function(e){var t=sessionStorage.getItem(e);if(t)return JSON.parse(t);var n=m[e]();return sessionStorage.setItem(e,JSON.stringify(n)),n},v=function(e,t){sessionStorage.setItem(e,JSON.stringify(t))},g=n(10),b={id:"local",maps:[{width:15,height:10,images:{}}]},O=Object(p.c)({name:"game",initialState:b,reducers:{forkGame:function(e,t){e.id=t.payload},loadGame:function(e,t){return t.payload},setDimensions:ie((function(e,t){var n=t.payload,r=n.map,a=n.width,o=n.height;e.maps[r].width=a,e.maps[r].height=o})),addImage:ie((function(e,t){var n=t.payload,r=n.map,a=n.img;e.maps[r].images[a.id]=a})),updateImage:ie((function(e,t){var n=t.payload,r=n.map,a=n.id,o=n.img;e.maps[r].images[a]=Object(g.a)(Object(g.a)({},e.maps[r].images[a]),o)})),reset:ie((function(e,t){return b}))}}),y=O.reducer,E=O.actions,j=E.setDimensions,w=E.addImage,S=E.updateImage,x=E.reset,P=E.loadGame,T=E.forkGame,D={online:[],data:h("players")},k=Object(p.c)({name:"players",initialState:D,reducers:{playerJoined:ie((function(e,t){e.online.push(t.payload),e.data[t.payload]=e.data[t.payload]||{name:null}})),removePlayer:ie((function(e,t){e.online=e.online.filter((function(e){return e!==t.payload}))})),changeName:ie((function(e,t){e.data[t.payload.player].name=t.payload.name}))}}),_=k.reducer,C=k.actions,R=C.playerJoined,N=C.removePlayer,I=C.changeName;var M=function(e){return new Promise((function(t){return setTimeout(t,e)}))},A=Object(p.b)("toast/issue",function(){var e=Object(d.a)(f.a.mark((function e(t,n){var r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.dispatch,a=Date.now(),r(U({id:Date.now(),msg:t})),e.next=5,M(5e3);case 5:r(H(a));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),L=Object(p.c)({name:"toast",initialState:{toasts:[]},reducers:{addToast:function(e,t){var n=t.payload;e.toasts.push(n)},removeToast:function(e,t){var n=t.payload;e.toasts=e.toasts.filter((function(e){return e.id!==n}))}}}),J=L.reducer,G=L.actions,U=G.addToast,H=G.removeToast,Y=n(25),W=n.n(Y),F=Object({NODE_ENV:"production",PUBLIC_URL:"/battlegrid",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_PEERJS_HOST:"peers-peerjs-server-3.glitch.me",REACT_APP_PEERJS_PORT:"443"}),X=F.REACT_APP_PEERJS_HOST,K=F.REACT_APP_PEERJS_PORT;function V(e){return B.apply(this,arguments)}function B(){return(B=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("ENV??",Object({NODE_ENV:"production",PUBLIC_URL:"/battlegrid",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_PEERJS_HOST:"peers-peerjs-server-3.glitch.me",REACT_APP_PEERJS_PORT:"443"})),n=new W.a(t,{debug:3,host:X,secure:!0,port:K?parseInt(K):void 0,path:"/"}),e.abrupt("return",new Promise((function(e,t){var r=function(e){o(),t("Error establishing peer: ".concat(e))},a=function(){o(),console.log("OPENING?"),e(n)},o=function(){n.off("open",a),n.off("error",r)};n.on("open",a),n.on("error",r)})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e,t,n){return q.apply(this,arguments)}function q(){return(q=Object(d.a)(f.a.mark((function e(t,n,r){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.connect(n,{metadata:r}),e.abrupt("return",new Promise((function(e,t){var n=function(e){o(),t("Error establishing peer: ".concat(e))},r=function(){o(),e(a)},o=function(){a.off("open",r),a.off("error",n)};a.on("open",r),a.on("error",n)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e,t,n){return Z.apply(this,arguments)}function Z(){return(Z=Object(d.a)(f.a.mark((function e(t,n,r){var a,o,c,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(){return(i=Object(d.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(a,t,{client_id:n});case 2:return o=e.sent,setTimeout((function(){return r.onConnect()}),0),e.abrupt("return",new Promise((function(e,t){o.on("error",(function(){$(c,1e3)})),o.on("close",(function(){$(c,1e3)}));o.on("data",(function t(n){o.off("data",t),o.on("data",r.onMessage),r.onInitialMessage(n),e(n)})),o.on("error",(function(){return r.onDisconnect()})),o.on("close",(function(){return r.onDisconnect()}))})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)},c=function(){return i.apply(this,arguments)},e.next=4,V();case 4:return a=e.sent,e.next=7,c();case 7:return e.abrupt("return",{id:n,send:function(e){o.send(e)}});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t){setTimeout(Object(d.a)(f.a.mark((function n(){return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e();case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),$(e,t);case 8:case"end":return n.stop()}}),n,null,[[0,5]])}))),t)}var ee=n(26);function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(d.a)(f.a.mark((function e(t,n){var r,a,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(t);case 2:return r=e.sent,a=new Map,o=function(e,t){var n,r=Object(ee.a)(a);try{for(r.s();!(n=r.n()).done;){var o=Object(u.a)(n.value,2),c=o[0],i=o[1];c!==t&&i.send(e)}}catch(s){r.e(s)}finally{r.f()}},r.on("connection",(function(e){return e.on("open",(function(){var t=e.metadata.client_id;console.log("NEW CLIENT",t),a.set(t,e),e.on("data",(function(e){o(e,t),n.onMessage(e)})),e.on("close",(function(){a.delete(t),n.onDisconnect(t)})),e.on("error",(function(){a.delete(t),n.onDisconnect(t)})),n.onConnect(e.metadata.client_id)}))})),n.onStartup(),e.abrupt("return",{id:t,send:o,sendTo:function(e,t){a.get(e).send(t)}});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re={conn:null},ae=Object(p.b)("comms/connect",function(){var e=Object(d.a)(f.a.mark((function e(t,n){var r,a,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,a=n.dispatch,o=r().comms.clientId,e.prev=2,e.next=5,Q(t,o,{onMessage:function(e){a(e)},onDisconnect:function(){a(ce.actions.disconnected())},onInitialMessage:function(e){a(e)},onConnect:function(){a(ce.actions.connected())}});case 5:re.conn=e.sent,console.log("connected to server!"),e.next=14;break;case 9:throw e.prev=9,e.t0=e.catch(2),a(A("joinFailure")),console.log(e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}()),oe=Object(p.b)("comms/host",function(){var e=Object(d.a)(f.a.mark((function e(t,n){var r,a,o,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState,a=n.dispatch,o=r().comms.clientId,e.next=4,te(o,{onConnect:function(e){var t;c.sendTo(e,{type:"STATE_SYNC",payload:{game:(t=r()).game,players:t.players}}),a(R(e))},onMessage:function(e){a(e)},onDisconnect:function(e){a(N(e))},onStartup:function(){a(R(o))}});case 4:return c=e.sent,re.conn=c,v("was_hosting",c.id),a(T(c.id)),window.history.pushState(null,"","?game=".concat(c.id)),e.abrupt("return",c.id);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),ce=Object(p.c)({name:"comms",initialState:{status:"offline",hosting:!1,clientId:h("comms_id"),gameId:null},reducers:{disconnected:function(e,t){e.status="pending"},connected:function(e,t){e.status="connected"}},extraReducers:function(e){e.addCase(ae.pending,(function(e,t){e.status="pending"})),e.addCase(ae.fulfilled,(function(e,t){e.gameId=t.gameId,e.status="connected"})),e.addCase(ae.rejected,(function(e,t){e.status="offline"})),e.addCase(oe.pending,(function(e,t){e.status="pending"})),e.addCase(oe.fulfilled,(function(e,t){var n=t.payload;e.status="connected",e.gameId=n,e.hosting=!0})),e.addCase(oe.rejected,(function(e,t){e.status="offline"}))}});function ie(e){return{reducer:e,prepare:function(e){return{payload:e,meta:re.conn?{shared:!0,src:re.conn.id}:{}}}}}var ue=ce.reducer;n(45);function se(e){return[e.clientX,e.clientY]}function le(e){return e.map(Math.floor)}function fe(e,t){return[e[0]+t[0],e[1]+t[1]]}n(46);var de=n(13),pe=Object(r.memo)(Object(r.forwardRef)((function(e,t){return a.a.createElement(de.b.div,Object.assign({},e,{ref:t,style:Object(g.a)({position:"absolute"},e.style),initial:!1,transition:{type:"tween",ease:"easeOut",duration:.2},animate:{left:e.loc[0]+"em",top:e.loc[1]+"em",width:e.dim[0]+"em",height:e.dim[1]+"em"}}),e.children)})));var me=a.a.memo((function(e){return a.a.createElement("svg",{viewBox:"0 0 ".concat(e.width+.025," ").concat(e.height+.025),style:{position:"absolute",left:"".concat(-.0125,"em"),top:"".concat(-.0125,"em"),width:"".concat(e.width+.025,"em"),height:"".concat(e.height+.025,"em"),pointerEvents:"none",transition:"position 2s"}},a.a.createElement("defs",null,a.a.createElement("pattern",{id:"grid",width:"1",height:"1",patternUnits:"userSpaceOnUse",shapeRendering:"geometricPrecision"},a.a.createElement("path",{d:"M 1 0 L 0 0 0 1",fill:"none",stroke:"gray",strokeWidth:.05}))),a.a.createElement("rect",{style:{pointerEvents:"none"},x:0,y:0,width:e.width+.025,height:e.height+.025,fill:"url(#grid)"}))}));var he=function(e){var t=Object(r.useRef)(null),n=Object(r.useCallback)((function(n){(t.current||"mouse"===n.type)&&(n.stopPropagation(),e.onSelectionDrag(se(n)))}),[e]),o=Object(r.useCallback)((function(n){null!==t.current&&(n.preventDefault(),n.stopPropagation(),e.onSelectionDrop(se(n)),t.current=null)}),[e]),c=Object(r.useRef)();return Object(r.useEffect)((function(){var e;null===(e=c.current)||void 0===e||e.addEventListener("touchmove",(function(e){return e.preventDefault()}),{passive:!1})})),a.a.createElement(pe,{ref:c,loc:e.loc,dim:e.dim,style:{border:"2px solid highlight",boxShadow:"0 0 10px highlight"},onPointerDown:function(e){e.preventDefault(),e.stopPropagation(),e.currentTarget.setPointerCapture(e.pointerId),t.current=se(e)},onPointerMoveCapture:n,onPointerUpCapture:o})},ve=n(31);function ge(e){return 96*e}function be(e){return e/96}var Oe=Object(r.memo)(Object(r.forwardRef)((function(e,t){var n=Object(r.useRef)(null),o=Object(r.useState)(null),c=Object(u.a)(o,2),i=c[0],s=c[1],l=Object(r.useState)(1),f=Object(u.a)(l,2),d=f[0],p=f[1],m=Object(r.useState)({width:0,height:0}),h=Object(u.a)(m,2),v=h[0],g=h[1],b=Object(r.useMemo)((function(){return console.log(v),[Math.max(0,(v.width-ge(e.width)*d)/2),Math.max(0,(v.height-ge(e.height)*d)/2)]}),[e.width,e.height,v,d]),O=Object(r.useCallback)((function(e,t){var r=Math.min(2,Math.max(.5,d+t)),a=r-d;p(r);var o=n.current.scrollLeft,c=n.current.scrollTop;s([o+e[0]*a,c+e[1]*a])}),[d]),y=Object(r.useCallback)((function(e){var t=Object(u.a)(e,2),r=t[0],a=t[1],o=r+n.current.scrollLeft,c=a+n.current.scrollTop;return[(o-b[0])/d,(c-b[1])/d]}),[b,d]);Object(r.useImperativeHandle)(t,(function(){return{clientToGrid:function(){return y.apply(void 0,arguments).map(be)}}}),[y]);var E=Object(r.useCallback)((function(e){if(e.ctrlKey){e.preventDefault(),e.stopPropagation();var t=y([e.clientX,e.clientY]),n=.08*Math.max(-1,Math.min(1,-e.deltaY));O(t,n)}}),[O,y]);Object(r.useEffect)((function(){var e=n.current;return e.addEventListener("wheel",E,{passive:!1}),function(){return e.removeEventListener("wheel",E)}}),[E]);var j=Object(r.useRef)(0);return Object(r.useEffect)((function(){var e=n.current,t=function(e){e.preventDefault(),e.stopPropagation(),j.current=e.scale},r=function(e){e.preventDefault(),e.stopPropagation();var t=y([e.clientX,e.clientY]),n=e.scale-j.current;j.current=e.scale,console.log(n),O(t,n)};return e.addEventListener("gesturestart",t),e.addEventListener("gesturechange",r),function(){e.removeEventListener("gesturestart",t),e.removeEventListener("gesturechange",r)}}),[y,O,d]),Object(r.useLayoutEffect)((function(){var e=n.current,t=new ResizeObserver((function(e){var t=e.pop().contentRect;g({width:t.width,height:t.height})}));return t.observe(e),function(){return t.disconnect()}}),[]),Object(r.useLayoutEffect)((function(){var e;i&&((e=n.current).scrollTo.apply(e,Object(ve.a)(i)),s(null))}),[i]),a.a.createElement("div",{className:"viewport",ref:n,style:{overflow:"scroll",position:"relative"}},a.a.createElement("div",{className:"gridsvg",style:{width:"".concat(e.width,"in"),height:"".concat(e.height,"in"),fontSize:"1in",position:"absolute",transform:"translate(".concat(b[0],"px, ").concat(b[1],"px) scale(").concat(d,")"),transformOrigin:"0 0",overflow:"hidden"}},e.children))})));function ye(e){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(d.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FileReader,e.abrupt("return",new Promise((function(e,r){n.onload=function(){return e(n.result)},n.readAsDataURL(t)})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(e){var t;return(null===(t=(new DOMParser).parseFromString(e,"text/html").querySelector("img"))||void 0===t?void 0:t.src)||null}var we=Object(r.memo)((function(e){var t,n=Object(r.useRef)(null),o=Object(r.useRef)(null),c=Object(r.useState)(null),s=Object(u.a)(c,2),l=s[0],p=s[1],m=Object(r.useRef)(null),h=Object(r.useRef)(null),v=Object(i.c)((function(e){return e.game.maps[0].images})),g=Object(i.b)(),b=function(e,t,n){var a=Object(r.useState)(0),o=Object(u.a)(a,2),c=o[0],i=o[1],s=Object(r.useState)({x:0,y:0}),l=Object(u.a)(s,2),f=l[0],d=l[1];return[c>0,f,{onDragEnter:function(e){e.preventDefault(),e.stopPropagation();var t=[e.clientX,e.clientY],n=t[0],r=t[1];i((function(e){return e+1})),d({x:n,y:r})},onDragLeave:function(e){e.preventDefault(),e.stopPropagation();var t=[e.clientX,e.clientY],n=t[0],r=t[1];i((function(e){return e-1})),d({x:n,y:r})},onDragOver:function(e){e.preventDefault(),t(e.clientX,e.clientY)},onDrop:function(e){e.preventDefault();var t=[e.clientX,e.clientY],r=t[0],a=t[1];i(0),d({x:r,y:a}),n(e)}}]}(0,(function(e,t){if(h.current){var n=m.current.clientToGrid([e,t]);h.current.style.left=Math.floor(n[0])+"em",h.current.style.top=Math.floor(n[1])+"em"}}),function(){var e=Object(d.a)(f.a.mark((function e(t){var n,r,a,o,c,i,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=m.current.clientToGrid([t.clientX,t.clientY]),o=null!==(n=null===(r=t.dataTransfer)||void 0===r?void 0:r.items)&&void 0!==n?n:[],c=function(e){console.log(e);var t={id:""+Math.random(),loc:[Math.floor(a[0]),Math.floor(a[1])],dim:[1,1],href:e};g(w({map:0,img:t}))},console.log("DataItems",o.length),i=0;case 5:if(!(i<o.length)){e.next=25;break}if(console.log(o[i].type),!o[i].type.startsWith("image/")){e.next=13;break}return e.next=10,ye(o[i].getAsFile());case 10:return u=e.sent,c(u),e.abrupt("return");case 13:if("text/html"!==o[i].type){e.next=16;break}return o[i].getAsString((function(e){return c(je(e))})),e.abrupt("return");case 16:if("application/x-moz-file-promise-url"!==o[i].type){e.next=21;break}return o[i].getAsString(c),e.abrupt("return");case 21:"string"===o[i].kind&&function(){var e=o[i].type;o[i].getAsString((function(t){return console.log(e,t)}))}();case 22:i++,e.next=5;break;case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),O=Object(u.a)(b,3),y=O[0],E=O[1],j=O[2];return y&&(t=m.current.clientToGrid([E.x,E.y])),a.a.createElement("div",Object.assign({className:"grid"},j,{ref:n}),a.a.createElement(Oe,{ref:m,baseScalar:1,baseUnit:"in",width:e.dimensions[0],height:e.dimensions[1]},y?a.a.createElement("div",{ref:h,key:"hover",style:{position:"absolute",left:Math.floor(t[0])+"em",top:Math.floor(t[1])+"em",width:"1em",height:"1em",background:"#aaa"}}):null,Object.values(v).map((function(e){var t;return a.a.createElement(pe,{key:e.id,loc:fe(e.loc,(null===(t=o.current)||void 0===t?void 0:t.id)===e.id?l:[0,0]),dim:e.dim,onPointerDown:function(t){t.preventDefault(),o.current=e,p([0,0])}},a.a.createElement("img",{onDragStart:function(e){return e.preventDefault()},alt:"",src:e.href,style:{display:"block",width:"100%",height:"100%"}}))})),a.a.createElement(me,{width:e.dimensions[0],height:e.dimensions[1]}),o.current&&a.a.createElement(he,{key:"",loc:fe(l,o.current.loc),dim:o.current.dim,onSelectionDrag:function(e){return p(le((t=m.current.clientToGrid(e),n=o.current.loc,[t[0]-n[0],t[1]-n[1]])));var t,n},onSelectionDrop:function(e){var t=le(m.current.clientToGrid(e));g(S({map:0,id:o.current.id,img:{loc:t}})),p(null),o.current=null}})))}));n(47);function Se(){var e=Object(i.c)((function(e){var t;return"connected"===e.comms.status&&null===(null===(t=e.players.data[e.comms.clientId])||void 0===t?void 0:t.name)})),t=Object(i.c)((function(e){return e.comms.clientId})),n=Object(i.b)(),o=Object(r.useCallback)((function(e){e.preventDefault();var r=new FormData(e.nativeEvent.target).get("name");n(I({player:t,name:r}))}),[t,n]);return e?a.a.createElement("div",{id:"join"},a.a.createElement("form",{style:{display:"flex",flexDirection:"column",maxWidth:"480px",background:"red"},onSubmit:o},a.a.createElement("label",{htmlFor:"name"},"Display Name:",a.a.createElement("input",{name:"name",type:"text",defaultValue:""})),a.a.createElement("button",{type:"submit"},"Join"))):null}n(48);function xe(e){var t=Object(i.c)((function(e){return e.toast.toasts})),n=Object(s.a)().t;return a.a.createElement("div",{className:"toastArea"},a.a.createElement(de.a,null,t.map((function(e){return a.a.createElement(de.b.div,{className:"toast",initial:{position:"relative",opacity:0},animate:{position:"relative",opacity:1},exit:{position:"relative",opacity:0},layout:!0,key:e.id},n(e.msg))}))))}n(54);var Pe=function(e){return a.a.createElement("div",{className:"toolbar"},e.children)};n(55);function Te(){return a.a.createElement("div",{className:"spinner"},a.a.createElement("div",{className:"double-bounce1"}),a.a.createElement("div",{className:"double-bounce2"}))}var De=function(){var e=Object(i.c)((function(e){return console.log(e),e.comms})),t=Object(r.useState)((function(){return 0})),n=Object(u.a)(t,2),o=n[0],c=(n[1],Object(i.c)((function(e){return[e.game.maps[o].width,e.game.maps[o].height]}))),l=Object(i.b)(),f=Object(s.a)().t,d=Object(i.c)((function(e){return e.players.online.map((function(t){return e.players.data[t].name}))}));return a.a.createElement("div",{className:"App"},a.a.createElement(Se,null),a.a.createElement(xe,null),a.a.createElement(we,{dimensions:c}),a.a.createElement(Pe,null,a.a.createElement("button",{onClick:function(){return l(j({map:o,width:c[0]+1,height:c[1]}))}},"Add Column"),a.a.createElement("button",{onClick:function(){return l(j({map:o,width:c[0],height:c[1]+1}))}},"Add Row"),a.a.createElement("button",{onClick:function(){return l(x({}))}},"Reset"),a.a.createElement("button",{onClick:function(){return l(A(f("hello")))}},"Say hi"),"offline"===e.status&&a.a.createElement("button",{onClick:function(){return l(oe())}},"Host"),"pending"===e.status&&a.a.createElement(Te,null),e.hosting&&"hosting: ".concat(e.gameId),d.map((function(e){return a.a.createElement("p",null,e||"unknown")}))))},ke=n(21),_e=n(30),Ce=n(14);ke.a.use(_e.a).use(Ce.e).init({debug:!0,lng:"en",fallbackLng:"en",whitelist:["en","de"],interpolation:{escapeValue:!1},backend:{loadPath:"/battlegrid/locales/{{lng}}/{{ns}}.json"}});ke.a,n(56);var Re=n(8),Ne=Object(Re.c)({comms:ue,game:y,toast:J,players:_}),Ie=Ne(void 0,{type:"null"}),Me=Object(p.a)({reducer:function(e,t){return"STATE_SYNC"===t.type?function(e,t){return Object(g.a)(Object(g.a)({},e),{},{game:t.payload.game,players:t.payload.players})}(e,t):Ne(e,t)},middleware:function(e){return e().prepend((function(e){return function(e){return function(t){var n,r;return console.log("connection?",re.conn),re.conn&&(null===(n=t.meta)||void 0===n?void 0:n.shared)&&(null===(r=t.meta)||void 0===r?void 0:r.src)===re.conn.id&&re.conn.send(t),e(t)}}}))},preloadedState:Ie});Me.subscribe((function(){var e=Me.getState();console.log(e),function(e,t){sessionStorage.setItem(e,JSON.stringify(t))}(e.game.id,e.game),v("players",e.players.data)}));var Ae=Me,Le=new URLSearchParams(window.location.search).get("game"),Je=function(e){var t=sessionStorage.getItem(e);return t?JSON.parse(t):null}(null!==Le&&void 0!==Le?Le:"local");Le?(console.log("Found game: ",Le),h("was_hosting")===Le?(console.log("REHOSTING!"),Je&&Ae.dispatch(P(Je)),h("players"),Ae.dispatch(oe())):(console.log("Huh"),Ae.dispatch(ae(Le)))):Je&&Ae.dispatch(P(Je)),c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(r.Suspense,{fallback:null},a.a.createElement(i.a,{store:Ae},a.a.createElement(De,null)))),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.3783d535.chunk.js.map